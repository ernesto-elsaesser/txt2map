<html>
  <head>
    <title>txt2map</title>
    <style>
      .container { margin: 20px auto 40px; text-align: center; }
      #input { width: 80%; height: 300px; margin: 0 auto 20px; }
      #button { font-size: 18px; color: blue; }
      #output { width: 80%; min-height: 100px; margin: 0 auto 40px; }
      a { cursor: pointer; font-weight: bold; }
      span { background-color: lightgreen; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Input</h1>
      <textarea id="input"></textarea><br/>
      <a onclick="post()" id="button">PARSE</a><br />
      <h1>Output</h1>
      <div id="output"></div>
      <p>Source: <a href="https://github.com/ernesto-elsaesser/txt2map" target="_blank">https://github.com/ernesto-elsaesser/txt2map</a></p>
    </div>

    <script>
    var input = document.getElementById('input');
    var button = document.getElementById('button');
    var output = document.getElementById('output');

    function post() {

      output.value = '';

      toggle(true);
      fetch('/', {method: 'POST', body: input.value})
      .then(function (res) {
        res.text().then(finish);
      }).catch(function (err) {
        finish(err.toString(), true)
      });
    }

    function finish(html, failed) {
      if (failed) {
        output.style.color = 'red';
      } else {
        output.style.color = 'black';
      }
      output.innerHTML = html;
      toggle(false);
    }

    function toggle(loading) {
      if (loading) {
        button.innerHTML = 'PARSING ...';
        button.style.color = 'grey';
        button.onclick = '';
      } else {
        button.innerHTML = 'PARSE';
        button.style.color = 'blue';
        button.onclick = post;
      }
    }
    </script>
  </body>
</html>